<script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization',
       'version':'1','packages':['timeline']}]}"></script>
<script src="jquery-2.0.3.min.js"></script>
<script type="text/javascript">
google.setOnLoadCallback(drawChart);

function drawChart() {
  var container = document.getElementById('container');

//  grabData();
  var batchJobExecutionData = mockData();

  var chartRows = convert(batchJobExecutionData);

  var chart = new google.visualization.Timeline(container);

  var dataTable = new google.visualization.DataTable();

  dataTable.addColumn({ type: 'string', id: 'Batch Job' });
  dataTable.addColumn({ type: 'date', id: 'Start' });
  dataTable.addColumn({ type: 'date', id: 'End' });

  // fetch execution data from graphite

  //dataTable.addRows(chartRows);

  //chart.draw(dataTable);
}

function grabData() {
  var url = "http://graphite.sf.gid.gap.com/render/?&width=1024&height=768&bgcolor=white&fgcolor=black&majorGridLineColor=black&minorGridLineColor=grey&title=Transactions%20per%20second&vtitle=Transactions&target=alias%28sum%28rrd-longterm.cllwmapc003.gid-nwmsAgentOutboundPickingSrv-TimerMonitor_WMSCreateWaveAgentExecuteJobTimer.counter-TotalHits.value%29,%27WMSCreate_tps%27%29&target=alias%28sum%28rrd-longterm.cllwmapc003.gid-nwmsAgentOutboundPickingSrv-TimerMonitor_WMSReleaseWaveAgentExecuteJobTimer.counter-TotalHits.value%29,%27WMSRelease_tps%27%29&target=alias%28sum%28rrd-longterm.cllwmapc003.gid-nwmsAgentOutboundPickingSrv-TimerMonitor_WMSContainerizeWaveAgentExecuteTaskTimer.counter-TotalHits.value%29,%27WMSContainerize_tps%27%29&from=16:00_20140519&until=16:30_20140519&format=json";
  $.getJSON(url, function(data) {
      alert(data);
  });
}

function mockData() {
  return [{"target": "rrd-longterm.cllwmapp011.gid-nwms1JbSrv-TimerMonitor_CartonCleanupFilterAPITimer.counter-TotalDuration.value", "datapoints": [[0.0, 1403160060], [0.0, 1403160120], [0.0, 1403160180], [0.0, 1403160240], [0.0, 1403160300], [0.0, 1403160360]]}, {"target": "rrd-longterm.cllwmapp011.gid-nwms1JbSrv-TimerMonitor_GIDPrintSVCShipmentsInvokeTimer.counter-TotalDuration.value", "datapoints": [[null, 1403160060], [null, 1403160120], [null, 1403160180], [null, 1403160240], [null, 1403160300], [null, 1403160360], [null, 1403160420], [null, 1403160480]]}, {"target": "rrd-longterm.cllwmapp011.gid-nwms1JbSrv-TimerMonitor_YFSEventManagerRaiseEventTimer_INVENTORY_CHANGE_SUPPLY_CHANGE_12.counter-TotalDuration.value", "datapoints": [[0.0, 1403160060], [0.0, 1403160120], [0.0, 1403160180], [0.0, 1403160240], [0.0, 1403160300], [0.0, 1403160360], [0.0, 1403160420], [0.0, 1403160480], [0.0, 1403160540], [0.0, 1403160600], [0.0, 1403160660], [0.0, 1403160720], [0.0, 1403160780], [0.0, 1403160840]]}];
}

function convert(data) {
  console.log(data);
  //var chartData = [];
  jQuery.each(data, function(index, element) {
    var metric = element;
    var metric_name = metric.target;
    console.log(metric_name);
    var datapoints = metric.datapoints;
    $.each(datapoints, function(index, element){
      console.log(element[0] + " " + element[1]);
    });

  });
}
</script>
<div id="container" style="width: 100%; height: 100%;"></div>
